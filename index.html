<!doctype html>
<html lang="fr">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
        <title>Turtle Timer üê¢</title>
    </head>
    <body>
        <div class="loader show" id="loader">
            <div class="spinner" id="spinner">
            </div>
            <div class="bouncer" id="bouncer">
                <div id="bouncer-1"></div>
                <div id="bouncer-2"></div>
                <div id="bouncer-3"></div>
            </div>
        </div>

        <div class="mode clock hide" id="mode-clock">
            <button onclick="Clock.displaySeconds()" class="Button Clock SecondsButton" id="SecondsButton">Afficher les secondes</button>
            <button onclick="Clock.toggleType()" class="Button Clock ToggleButton" id="ToggleButton">Analogique</button>

            <img class="cadran hide" id="clock-cadran" src="https://i.ibb.co/Xxh33tMG/Cadran.png" alt="">
            <img class="horloge hide" id="clock-horloge" src="https://i.ibb.co/qv3d3zF/Horloge.png" alt="">
            
            <div class="clock-components" id="clock-components">
                <div class="hand second hide" id="second"></div>
                <div class="hand minute hide" id="minute"></div>
                <div class="hand hour hide" id="hour"></div>
                <div class="clock-digital hide" id="clock-digital" aria-live="polite" aria-atomic="true">--:--:--</div>
            </div>
        </div>

        <div class="mode chrono hide" id="mode-chrono" >
            <button onclick="Chrono.freezeScreen()" class="Button Chrono Freeze" id="FreezeButton">Figer l'√©cran</button>
            <button onclick="Chrono.startStop()" class="Button Chrono Start-Stop" id="StartStopButton">D√©marrer</button>
            <button onclick="Chrono.reset()" class="Button Chrono Reset" id="ResetButton">R√©initialiser</button>

            <img class="cadran" id="chrono-cadran" src="https://i.ibb.co/Xxh33tMG/Cadran.png" alt="">
            
            <div class="chrono-components" id="chrono-components">
                <div class="chrono-digital" id="chrono-digital" aria-live="polite" aria-atomic="true">--:--:--</div>
            </div>
        </div>

        <div class="mode timer hide" id="mode-timer">
            <button onclick="" class="Button Timer First" id="Button1">Bouton 1</button>
            <button onclick="" class="Button Timer Second" id="Button2">Bouton 2</button>

            <img class="cadran" id="timer-cadran" src="https://i.ibb.co/Xxh33tMG/Cadran.png" alt="">
            
            <div class="timer-components" id="timer-components">
                <div class="timer-digital" id="timer-digital" aria-live="polite" aria-atomic="true">--:--:--</div>
            </div>
        </div>

        <div class="mode credits hide" id="mode-credits">
            <p class="show" id="credits-owner">Ce site internet est r√©alis√© par : <span style="font-weight: bold;">TurtleSmile</span></p>
            <p class="show" id="credits-problem">Pour toute suggestion, demande ou remarque, merci de me contacter sur <a href="https://discord.gg/H26UBrEsTc" target="_blank">Discord</a></p>
        </div>

        <div class="mode problem hide" id="mode-problem">
            <p id="credits-warning"><span style="font-weight: bold;">Vous ne pouvez pas faire √ßa, merci de respecter les droits d'auteur !</span></p>
        </div>

        <div class="mode building hide" id="mode-building">
            <p id="credits-building"><span style="font-weight: bold;">Cette partie du site est en construction, merci de revenir plus tard !</span></p>
        </div>

        <div class="sidebar" id="sidebar">
            <button onclick="Sidebar.selectMode('clock')" id="clock-button">Horloge <i class="fa-solid fa-clock"></i></button>
            <button onclick="Sidebar.selectMode('chrono')" id="chrono-button">Chrono <i class="fa-solid fa-stopwatch"></i></button>
            <button onclick="Sidebar.selectMode('building')" id="building-button">En travaux <i class="fa-solid fa-wrench"></i></button>
            <!--- <button onclick="Sidebar.selectMode('timer')" id="timer-button">Minuteur <i class="fa-solid fa-hourglass-half"></i></button> --->
            <div class="sidebar-separator" id="sidebar-separator"></div>
            <button onclick="Sidebar.selectMode('credits')" id="credits-button">Cr√©dits <i class="fa-solid fa-user"></i></button>
        </div>

        <button onclick="Sidebar.toggle()" class="sidebar-toggle" id="sidebar-toggle"><i class="fa-solid fa-bars"></i></button>
        <button onclick="toggleFullScreen()" class="fullscreen-toggle" id="fullscreen-toggle"><i class="fa-solid fa-expand"></i></button>
    </body>
    <footer>
        <h2 class="hide" id="legal-credits">¬© 2025 Turtle Timer üê¢ ‚Äî All Rights Reserved</h2>
    </footer>
    <style>
        body {
            margin:0;
            width: 100%;
            height: 100%;
            background: url("https://i.ibb.co/60D4QHrz/Fond-Horloge.png") no-repeat center center fixed;
            background-size: cover;
            transition:all 0.5s ease-in-out;
            overflow: hidden;
        }

        .loader {
            position: fixed;
            inset: 0;
            background: rgb(37, 82, 64);
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: all 0.6s ease-in-out;
        }
        .loader.hide {
            transform: scale(2);
        }

        .spinner {
            width: 20vw;
            aspect-ratio: 1 / 1;
            border-top: 1vh solid #fff;
            border-radius: 50%;
            animation: elastic-spin 1.5s cubic-bezier(0.68,-0.55,0.27,1.55) infinite;
        }
        .bouncer {
            display: flex;
            gap: 2vw;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .bouncer div {
            width: 3.5vw;
            aspect-ratio: 1 / 1;
            border-radius: 50%;
            background: #fff;
            animation: bounce 0.6s infinite alternate;
        }
        .bouncer div:nth-child(2) {
            animation-delay: 0.2s;
        }
        .bouncer div:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        .mode {
            margin:0;
            width: 100vw;
            height: 100vh;
            display:flex;
            align-items:center;
            justify-content:center;
            transition: all 0.5s ease-in-out;
        }

        img {
            position:fixed;
            transition: all 0.5s ease-in-out;
        }
        
        .cadran {
            top: 50vh;
            left: 50vw;
            transform: translate(-50%, -50%);
            width: 75vw;
            aspect-ratio: 7 / 3;
        }

        .horloge {
            top: 50vh;
            left: 50vw;
            transform: translate(-50%, -50%);
            width: 110vmin;
            aspect-ratio: 1 / 1;
        }

        .clock-components {
            position: fixed;
            width: 110vmin;
            height: auto;
            aspect-ratio: 1/1;
            pointer-events: none;
        }
        .chrono-components {
            position: fixed;
            top: 50vh;
            left: 50vw;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .clock-digital, .chrono-digital, .timer-digital {
            position: absolute;
            top: 50%;
            left: 50%;
            font-family: monospace;
            transform: translate(-50%, -50%);
            color: #255240;
            text-shadow: 0 2px 2px rgba(0,0,0,0.25);
            pointer-events: none;
        }

        .hand, .clock-digital, .chrono-digital, .timer-digital, h2 {
            transition: opacity 0.5s ease-in-out;
        }

        .ms {
            font-size: 0.35em;
            vertical-align: bottom;
            margin-left: 0.2em;
            width: 0.5vw;
        }

        .hand {
            position: absolute;
            left: 50%;
            top: 50%;
            transform-origin: 50% 100%;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.25);
        }
        .hand.hour {
            width: 1.2%;
            height: 20%;
            background: #255240;
        }
        .hand.minute {
            width: 1%;
            height: 30%;
            background: #70f3c1;
        }
        .hand.second {
            width: 0.8%;
            height: 35%;
            background: #ff3b3b;
        }

        .Button {
            position:fixed;
            top:0;
            margin:1em;
            padding:0.5em 1em;
            border-radius:4px;
            border:1px solid #fff;
            background-color:transparent;
            color:#fff;
            font-size:1.5vw;
            cursor: pointer;
            transition: all 0.5s ease-in-out;
            z-index: 9;
        }
        .Button:hover {
            background-color:rgba(255,255,255,0.1);
            border-color:rgba(255,255,255,0.5);
            transform: translateX(0.4vw);
        }
        .Button.Clock.ToggleButton {
            right: 22vw;
            width: 13vw;
        }
        .Button.Clock.SecondsButton {
            right:0;
            width: 20vw;
        }
        .Button.Chrono.Freeze {
            right: 30vw;
            width: 15vw;
        }
        .Button.Chrono.Start-Stop {
            right: 15vw;
            width: 13vw;
        }
        .Button.Chrono.Reset {
            right: 0;
            width: 13vw;
        }
        .Button.Timer.First {
            right: 15vw;
            width: 13vw;
        }
        .Button.Timer.Second {
            right: 0;
            width: 13vw;
        }

        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 15vw;
            min-width: 200px;
            height: 100%;
            background: rgba(37, 82, 64, 0.9);
            display: flex;
            flex-direction:column;
            gap: 1em;
            padding: 2em 1em;
            transition: all 0.5s ease-in-out;
            z-index: 10;
            align-items: stretch;
            transform: translateX(-100%);
            overflow-y: auto;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        .sidebar-separator {
            height: 1px;
            flex-shrink: 0;
            background-color: rgba(255,255,255,0.5);
            margin: 0.5em 0;
            width: 100%;
        }
        .sidebar button {
            width: 100%;
            padding: 1em;
            border: 1px solid #fff;
            border-radius: 8px;
            color: #fff;
            font-size: 1.5vw;
            background: transparent;
            cursor: pointer;
            transition: all 0.5s ease-in-out;
            flex-shrink: 0;
        }
        .sidebar button:hover {
            background: rgba(255,255,255,0.1);
            border-color:rgba(255,255,255,0.5);
            transform: translateX(0.4vw);
        }
        .sidebar.open {
            transform: translateX(0);
        }
        .sidebar-toggle, .fullscreen-toggle {
            position: fixed;
            z-index: 20;
            background: #255240;
            color: #fff;
            border: none;
            padding: 0.5em 1em;
            font-size: 1.5vw;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.5s ease-in-out;
        }
        .sidebar-toggle:hover, .fullscreen-toggle:hover {
            background-color:#427e66;
        }
        .sidebar-toggle {
            top: 3vh;
            left: 1.5vw;
        }
        .fullscreen-toggle {
            bottom: 3vh;
            right: 1.5vw;
        }

        .mode.credits, .mode.problem, .mode.building {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            display: flex;
            flex-direction:column;
            font-size: 3vw;
        }
        .mode.credits p, .mode.problem p, .mode.building p {
            margin: 0.2vh;
            color: #fff;
            width: 70%;
        }
        .mode.credits a {
            color: #fff;
            text-decoration: none;
        }
        .mode.credits a:hover {
            text-decoration: underline;
        }

        footer {
            text-align: center;
            padding: 1em;
            color: #fff;
            position: fixed;
            bottom: 0;
            width: 100%;
            font-size: 1.1vw;
        }

        .sidebar::-webkit-scrollbar {
            width:0.7vw;
            height: auto;
        }
        .sidebar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }
        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.5);
            border-radius: 10rem;
        }
        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.6);
        }

        .hide {
            opacity: 0;
            pointer-events:none;
        }
        .show {
            opacity: 1;
            pointer-events:all;
        }

        @keyframes bounce {
            to { transform: translateY(-1vh); opacity: 0.5; }
        }
        @keyframes elastic-spin {
            0% { transform: rotate(0deg); }
            60% { transform: rotate(300deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <script>
        /* ----------------- Helpers ----------------- */
        function setVisibility(el, show) {
            if (show) {
                el.classList.add("show");
                el.classList.remove("hide");
            } else {
                el.classList.add("hide");
                el.classList.remove("show");
            }
        }

        function pad(n){ return n.toString().padStart(2,'0'); }

        function toggleFullScreen() {
            const fullScreenButton = document.getElementById("fullscreen-toggle");
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        document.addEventListener("fullscreenchange", () => {
            const fullScreenButton = document.getElementById("fullscreen-toggle");
            if (document.fullscreenElement) {
                fullScreenButton.innerHTML = '<i class="fa-solid fa-compress"></i>';
            } else {
                fullScreenButton.innerHTML = '<i class="fa-solid fa-expand"></i>';
            }
        });

        document.addEventListener("contextmenu", (e) => e.preventDefault());

        document.addEventListener("keydown", (e) => {
            if (
                (e.ctrlKey && e.key.toLowerCase() === "u") ||
                (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "i") ||
                (e.key === "F12") ||
                (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "c") ||
                (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "j")
            ) {
                e.preventDefault();
                Sidebar.selectMode("problem");
            }
        });

        /* ----------------- Clock Module ----------------- */
        const Clock = (() => {
            const $hour = document.getElementById('hour');
            const $minute = document.getElementById('minute');
            const $second = document.getElementById('second');
            const $digital = document.getElementById('clock-digital');
            const $cadran = document.getElementById('clock-cadran');
            const $horloge = document.getElementById('clock-horloge');

            const $mode = document.getElementById('mode-clock');

            let showSeconds = false;

            function toggleType() {
                const btn = document.getElementById('ToggleButton');
                btn.disabled = true;

                if (btn.innerHTML === "Num√©rique") {
                    btn.innerHTML = "Analogique";
                    localStorage.setItem("clock-type", "Num√©rique");
                    setVisibility($hour,false);
                    setVisibility($minute,false);
                    setVisibility($second,false);
                    setTimeout(() => { setVisibility($cadran,true); setVisibility($horloge,false); }, 400);
                    setTimeout(() => { setVisibility($digital,true); }, 1000);
                } else {
                    localStorage.setItem("clock-type", "Analogique");
                    btn.innerHTML = "Num√©rique";
                    setVisibility($digital,false);
                    setTimeout(() => { setVisibility($cadran,false); setVisibility($horloge,true); }, 400);
                    setTimeout(() => { setVisibility($hour,true); setVisibility($minute,true); setVisibility($second,true); }, 1000);
                }

                setTimeout(() => btn.disabled = false, 2000);
            }

            function displaySeconds() {
                const btn = document.getElementById('SecondsButton');
                btn.disabled = true;

                btn.innerHTML = showSeconds ? "Afficher les secondes" : "Cacher les secondes";

                if ($digital.classList.contains("show")) {
                    setVisibility($digital, false);
                    setTimeout(() => {
                        setVisibility($digital,true); 
                        showSeconds = !showSeconds;
                        localStorage.setItem("display-seconds", showSeconds);
                    }, 500);
                } else {
                    showSeconds = !showSeconds;
                    localStorage.setItem("display-seconds", showSeconds);
                }

                setTimeout(() => btn.disabled = false, 1000);
            }

            window.addEventListener("DOMContentLoaded", () => {
                const clockType = localStorage.getItem("clock-type") || "Num√©rique";
                const displaySecondsLocalVar = localStorage.getItem("display-seconds") || "false";
                const btnType = document.getElementById('ToggleButton');
                const btnSec = document.getElementById('SecondsButton');

                if (displaySecondsLocalVar === "true") {
                    btnSec.innerHTML = "Cacher les secondes";
                    showSeconds = true;
                }

                if (clockType === "Analogique") {
                    btnType.innerHTML = "Num√©rique";
                    setVisibility($horloge, true);
                    setVisibility($hour, true);
                    setVisibility($minute, true);
                    if (showSeconds) setVisibility($second, true);
                } else {
                    setVisibility($cadran, true);
                    setVisibility($digital, true);
                }
            });

            function update() {
                const now = new Date();
                const hh = now.getHours();
                const mm = now.getMinutes();
                const ss = now.getSeconds();
                const ms = now.getMilliseconds();

                if ($hour.classList.contains("show")) {
                    const secAngle = (ss + ms/1000) * 6;
                    const minAngle = (mm + ss/60 + ms/(60*1000)) * 6;
                    const hourAngle = ((hh % 12) + mm/60 + ss/(60*60) + ms/(60*60*1000)) * 30;

                    $second.style.transform = `translate(-50%,-100%) rotate(${secAngle}deg)`;
                    $minute.style.transform = `translate(-50%,-100%) rotate(${minAngle}deg)`;
                    $hour.style.transform   = `translate(-50%,-100%) rotate(${hourAngle}deg)`;
                }
                if (showSeconds) {
                    if ($hour.classList.contains("show") && $second.classList.contains("hide")) {
                        setVisibility($second, true);
                    }
                    $digital.style.fontSize = "12vw";
                    $digital.innerHTML = `${pad(hh)}:${pad(mm)}:${pad(ss)}`;
                    if ($digital.classList.contains("show") && $horloge.classList.contains("show")) {
                        setVisibility($digital, false);
                    }
                } else {
                    if ($second.classList.contains("show")) {
                        setVisibility($second, false);
                    }
                    $digital.style.fontSize = "20vw";
                    $digital.innerHTML = `${pad(hh)}:${pad(mm)}`;
                    if ($digital.classList.contains("show") && $horloge.classList.contains("show")) {
                        setVisibility($digital, false);
                    }
                }
            }

            function loop() { 
                if ($mode.classList.contains("show")) {
                    update();
                }
                requestAnimationFrame(loop); 
            }

            /* Initialisation */
            loop();

            return { toggleType, displaySeconds };
        })();

        /* ----------------- Chrono Module ----------------- */
        const Chrono = (() => {
            const $cadran = document.getElementById('chrono-cadran');
            const $digital = document.getElementById('chrono-digital');
            const $startStop = document.getElementById('StartStopButton');
            const $reset = document.getElementById('ResetButton');
            const $freeze = document.getElementById('FreezeButton');

            let isrunning = false;
            let pending = false;
            let removePending;
            let freezed = false;
            let timeFreezed;
            let startTime;
            let elapsed;

            const $mode = document.getElementById('mode-chrono');

            function getTime() {
                elapsed = Date.now() - startTime;
                const totalSeconds = Math.floor(elapsed / 1000);
                const hh = Math.floor(totalSeconds / 3600);
                const mm = Math.floor((totalSeconds % 3600) / 60);
                const ss = totalSeconds % 60;
                let ms = elapsed % 1000;

                while (String(ms).length < 3) {
                    ms = "0" + String(ms);
                } 

                return `${pad(hh)}:${pad(mm)}:${pad(ss)}<span class='ms'>${pad(ms)}</span>`;
            }

            function update() {
                $digital.innerHTML = getTime();
                timeFreezed = $digital.innerHTML;
            }

            function startStop() {
                if (isrunning) {
                    $startStop.innerHTML = "D√©marrer";
                    isrunning = false;
                    if (pending) {
                        removePending = Date.now();
                    }
                    if (freezed) {
                        timeFreezed = getTime();
                    }
                } else {
                    $startStop.innerHTML = "Arretter";
                    isrunning = true;
                    if (!pending) {
                        startTime = Date.now();
                        pending = true;
                    } else {
                        startTime += Date.now() - removePending;
                    }
                }
            }

            function reset() {
                $startStop.innerHTML = "D√©marrer";
                isrunning = false;
                pending = false;
                if (freezed) {
                    timeFreezed = `00:00:00<span class='ms'>000</span>`;
                } else {
                    $digital.innerHTML = `00:00:00<span class='ms'>000</span>`;
                    timeFreezed = `00:00:00<span class='ms'>000</span>`;
                }
            }

            function freezeScreen() {
                if (!freezed) {
                    $freeze.innerHTML = "R√©tablir l'√©cran";
                    freezed = true;
                } else {
                    $freeze.innerHTML = "Figer l'√©cran";
                    freezed = false;
                    if (timeFreezed) {
                        $digital.innerHTML = timeFreezed;
                    }
                }
            }

            function loop() {
                if ($mode.classList.contains("show")) {
                    if (isrunning && !freezed) {
                        update();
                    }
                }
                requestAnimationFrame(loop); 
            }

            /* Initialisation */
            loop();
            $digital.style.fontSize = "11.5vw";
            $digital.innerHTML = "00:00:00<span class='ms'>000</span>";

            return { startStop, reset, freezeScreen };
        })();

        /* ----------------- Timer Module ----------------- */
        const Timer = (() => {
            const $cadran = document.getElementById('timer-cadran');
            const $digital = document.getElementById('timer-digital');
            const $startStop = document.getElementById('Button1');
            const $reset = document.getElementById('Button2');

            let $mode = document.getElementById('mode-timer');

            function update() {
                const now = new Date();
                const hh = now.getHours();
                const mm = now.getMinutes();
                const ss = now.getSeconds();
                const ms = now.getMilliseconds();

                $digital.style.fontSize = "12vw";
                $digital.innerHTML = `${pad(hh)}:${pad(mm)}:${pad(ss)}`;
            }

            function loop() { 
                if ($mode.classList.contains("show")) {
                    update();
                }
                requestAnimationFrame(loop); 
            }

            /* Initialisation */
            loop();

            return {  };
        })();

        /* ----------------- Sidebar Module ----------------- */
        const Sidebar = (() => {
            const sidebar = document.getElementById('sidebar');
            const toggleBtn = document.getElementById('sidebar-toggle');
            const legalcredits = document.getElementById('legal-credits');

            function toggle() {
                sidebar.classList.toggle("open");
                toggleBtn.style.left = sidebar.classList.contains("open")
                    ? `calc(${sidebar.offsetWidth}px + ${toggleBtn.offsetWidth / 2}px)`
                    : "1.5vw";
            }

            function selectMode(mode) {
                if (sidebar.classList.contains("open")) toggle();
                document.querySelectorAll('.mode').forEach(m => setVisibility(m,false));
                setVisibility(document.getElementById("mode-" + mode), true);
                if (mode !== "problem") {
                    localStorage.setItem("lastMode", mode);
                }
                if (mode === "credits") {
                    setVisibility(legalcredits, true);
                } else {
                    setVisibility(legalcredits, false);
                }
            }

            window.addEventListener("resize", () => {
                if (sidebar.classList.contains("open")) toggle();
            });

            window.addEventListener("DOMContentLoaded", () => {
                const lastMode = localStorage.getItem("lastMode") || "clock";
                document.querySelectorAll('.mode').forEach(m => setVisibility(m,false));
                setVisibility(document.getElementById("mode-" + lastMode), true);
                if (lastMode === "credits") {
                    setVisibility(legalcredits, true);
                } else {
                    setVisibility(legalcredits, false);
                }
            });

            window.addEventListener("load", () => {
                const loader = document.getElementById("loader");
                setTimeout(() => {
                    setVisibility(loader, false);
                }, 1000);
            });

            return { toggle, selectMode };
        })();
    </script>
</html>
